<!DOCTYPE html>
<!-- saved from url=(0041)https://antrail.github.io/rail/index.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Bee Network Rail Dashboard</title>

  <link rel="stylesheet" href="./Bee Network Rail Dashboard_files/leaflet.css">

  <style>
    :root{
 --bg: #0a0a0a;
 --border: rgba(255, 204, 0, .22);
 --text: #f6f6f6;
 --muted:#b7b7b7;
 --accent:#ffcc00;
 --shadow: 0 10px 30px rgba(0,0,0,.45);
 --radius: 14px;
}
*{ box-sizing:border-box; }
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    }

    .app{ height:100vh; display:grid; grid-template-rows: 64px 1fr; }

    header{
      display:flex; align-items:center; gap:14px;
      padding: 10px 14px;
      border-bottom:1px solid var(--border);
      background: linear-gradient(180deg, rgba(16,26,40,.95), rgba(11,15,20,.95));
      backdrop-filter: blur(6px);
    }

    .brand{ display:flex; align-items:center; gap:12px; min-width: 320px; }
    .logo{
      width:44px; height:44px; border-radius: 12px;
      background: rgba(255,255,255,.06);
      border:1px solid var(--border);
      display:flex; align-items:center; justify-content:center;
      overflow:hidden;
    }
    .logo img{ width:100%; height:100%; object-fit:contain; padding:6px; }
    .brand-title{ display:flex; flex-direction:column; line-height:1.1; }
    .brand-title .h1{ font-weight:650; letter-spacing:.2px; font-size:16px; }
    .brand-title .sub{ color:var(--muted); font-size:12px; margin-top:3px; }

    .header-right{ margin-left:auto; display:flex; align-items:center; gap:10px; }
    .pill{
      border:1px solid var(--border);
      background: rgba(255,255,255,.05);
      border-radius:999px;
      padding:8px 10px;
      font-size:12px;
      color:var(--muted);
      display:flex; align-items:center; gap:8px;
    }
    .dot{
      width:8px;height:8px;border-radius:999px;
      background: var(--accent);
      box-shadow: 0 0 0 4px rgba(255,204,0,.18);
    }

    main{ display:grid; grid-template-columns: 420px 1fr; min-height:0; }

    .sidebar{
      border-right:1px solid var(--border);
      background: radial-gradient(1200px 500px at 0% 0%, rgba(255,204,0,.12), transparent 40%),
                  linear-gradient(180deg, rgba(16,26,40,.8), rgba(11,15,20,.9));
      padding: 12px;
      overflow:auto;
    }

    .card{
      background: rgba(255,255,255,.04);
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 12px;
    }

    .kpis{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-bottom: 10px;
    }
    .kpi .label{ color:var(--muted); font-size:12px; }
    .kpi .value{ font-size:22px; font-weight:700; margin-top:2px; }

    .search{ margin: 10px 0; display:flex; gap:8px; }
    input[type="search"], select{
      width:100%;
      padding: 10px 12px;
      border-radius: 12px;
      border:1px solid var(--border);
      background: rgba(0,0,0,.25);
      color: var(--text);
      outline:none;
    }
    input[type="search"]::placeholder{ color: rgba(148,163,184,.8); }

    .btn{
      padding: 10px 12px;
      border-radius: 12px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.06);
      color: var(--text);
      cursor:pointer;
      font-weight:600;
      white-space:nowrap;
    }
    .btn:hover{ background: rgba(255,255,255,.10); }

    .section-title{
      margin: 10px 0 8px;
      font-weight:700;
      font-size:13px;
      color: var(--text);
      display:flex;
      align-items:center;
      justify-content:space-between;
    }
    .section-title .count{ color:var(--muted); font-weight:600; font-size:12px; }

    .list{ margin-top:8px; display:flex; flex-direction:column; gap:8px; }
    .row{
      display:flex;
      flex-direction:column;
      gap:6px;
      padding:10px 10px;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,.08);
      background: rgba(0,0,0,.18);
      cursor:pointer;
    }
    .row:hover{
      border-color: rgba(255,204,0,.40);
      background: rgba(255,204,0,.10);
    }
    .row .name{ font-weight:650; font-size:13px; }
    .row .meta{
      color:var(--muted);
      font-size:12px;
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }
    .row .meta a{ color: var(--accent); text-decoration: none; }
    .row .meta a:hover{ text-decoration: underline; }
    .row .desc{ color:var(--muted); font-size:12px; line-height:1.35; }

    #map{ height:100%; width:100%; }

    .leaflet-popup-content-wrapper,
    .leaflet-popup-tip {
      background: #0f0f0f;
      color: #e6edf3;
      border: 1px solid rgba(255,255,255,0.10);
    }
    .leaflet-popup-content a { color: #ffcc00; text-decoration:none; }
    .leaflet-popup-content a:hover { text-decoration:underline; }
    .leaflet-control-attribution{
      background: rgba(16,24,38,0.85) !important;
      color:#cbd5e1 !important;
    }
    .leaflet-control-attribution a{ color:#ffcc00 !important; }

    .pop-h{ color:#94a3b8; font-weight:700; margin-top:10px; }
    .pop-p{ margin-top:4px; color:#cbd5e1; font-size:12px; line-height:1.35; }
    .pop-links{ margin-top:12px; display:flex; gap:12px; flex-wrap:wrap; }

    /* Permanent station labels for pinned/termini */
    .station-label{
 background: rgba(10, 10, 10, 0.92);
 color: var(--text);
 border: 1px solid rgba(255, 204, 0, 0.50);
 padding: 4px 8px;
 border-radius: 999px;
 box-shadow: 0 10px 22px rgba(0,0,0,0.45);
 font-weight: 800;
 font-size: 12px;
 letter-spacing: .2px;
 white-space: nowrap;
}
.station-label.terminus{ border-color: rgba(255, 204, 0, 0.85); }
    .station-label.pinned{ border-color: rgba(255, 204, 0, 0.85); }

    /* Tools card */
    .tools-row{ display:flex; gap:8px; align-items:center; margin-top:10px; }
    .tool-links{ display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
    .tool-links a{
      color: var(--accent);
      text-decoration: none;
      font-size: 12px;
      font-weight: 700;
      padding: 6px 10px;
      border: 1px solid rgba(255,255,255,.10);
      border-radius: 999px;
      background: rgba(255,255,255,.05);
    }
    .tool-links a:hover{ background: rgba(255,255,255,.10); }
    .muted{ color: var(--muted); font-size: 12px; }
  </style>
</head>

<body data-cai-parent-url="https://antrail.github.io/rail/index.html">
  <div class="app">
    <header>
      <div class="brand">
        <div class="logo" title="Add your logo file to /assets and update the src below">
          <img src="./Bee Network Rail Dashboard_files/logo.png" alt="Bee Network Rail">
        </div>
        <div class="brand-title">
          <div class="h1">Bee Network Rail</div>
          <div class="sub">Map overview and links</div>
        </div>
      </div>

      <div class="header-right">
        <div class="pill"><span class="dot"></span> Static map</div>
        <div class="pill" id="buildStamp">Build: 2026-02-24</div>
      </div>
    </header>

    <main>
      <aside class="sidebar">

        <!-- Tools menu -->
        <div class="card">
          <div class="section-title" style="margin-top:0;">
            <span>Tools</span>
            <span class="count">Resources</span>
          </div>

          <div class="muted">
            Quick links to operational resources. Use the dropdown to open in a new tab.
          </div>

          <div class="tools-row">
            <select id="toolSelect" aria-label="Tools menu">
              <option value="">Choose a tool…</option>
              <option value="ccil">CCIL log</option>
              <option value="rtt">Realtime Trains</option>
              <option value="nre">National Rail Enquiries</option>
 <option value="railProcedures">Rail procedures</option>
            </select>
            <button class="btn" id="openToolBtn" type="button">Open</button>
          </div>

          
 <div class="tools-row" style="margin-top:10px; flex-wrap:wrap;">
   <label class="pill" style="gap:10px; cursor:pointer; user-select:none;">
     <input id="labelToggle" type="checkbox" checked style="accent-color: var(--accent); transform: scale(1.1);" />
     Show station labels
   </label>
   <label class="pill" style="gap:10px; cursor:pointer; user-select:none;">
     <input id="zoom14Toggle" type="checkbox" style="accent-color: var(--accent); transform: scale(1.1);" />
     Labels only at zoom ≥ 14
   </label>
 </div>
<div class="tool-links">
            <a href="https://ccil.clyx.net/CCIL/NewApplication/Default.aspx" target="_blank" rel="noopener">CCIL log</a>
            <a href="https://www.realtimetrains.co.uk/" target="_blank" rel="noopener">Realtime Trains</a>
            <a href="https://www.nationalrail.co.uk/" target="_blank" rel="noopener">National Rail Enquiries</a>
 <a href="https://tfgmserverteamoutlook.sharepoint.com/sites/TfGMControlTEST/Shared%20Documents/Forms/AllItems.aspx?id=%2Fsites%2FTfGMControlTEST%2FShared%20Documents%2FRail&p=true&ga=1" target="_blank" rel="noopener">Rail procedures</a>
          </div>
        </div>

        <div style="height:12px"></div>

        <div class="kpis">
          <div class="card kpi">
            <div class="label">Stations loaded</div>
            <div class="value" id="kpiStations">100</div>
          </div>
          <div class="card kpi">
            <div class="label">Showing</div>
            <div class="value" id="kpiShowing">100</div>
          </div>
        </div>

        <div class="card">
          <div class="section-title">
            <span>Find a station</span>
            <span class="count" id="resultCount">All: 100</span>
          </div>

          <div class="search">
            <input id="q" type="search" placeholder="Search station name…" autocomplete="off">
            <button class="btn" id="clearBtn" title="Clear" type="button">Clear</button>
          </div>

          <div class="section-title">
            <span>Stations</span>
            <span class="count" id="listCount">100 listed</span>
          </div>

          <div class="list" id="list"><div class="row">
          <div class="name">Altrincham</div>
          <div class="meta">
            <span>CRS: ALT</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/alt/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/ALT" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Ardwick</div>
          <div class="meta">
            <span>CRS: ADK</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/adk/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/ADK" target="_blank" rel="noopener">Realtime</a>
          </div>
          <div class="desc">Ardwick Station has a very limited service. Two trains a day run towards the city on Monday to Friday mornings, and two trains away from the city in the evening. No service at weekends.</div>
        </div><div class="row">
          <div class="name">Ashburys</div>
          <div class="meta">
            <span>CRS: ABY</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/aby/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/ABY" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Ashton-under-Lyne</div>
          <div class="meta">
            <span>CRS: AHN</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/ahn/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/AHN" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Atherton</div>
          <div class="meta">
            <span>CRS: ATN</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/atn/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/ATN" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Belle Vue</div>
          <div class="meta">
            <span>CRS: BLV</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/blv/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/BLV" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Blackrod</div>
          <div class="meta">
            <span>CRS: BLK</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/blk/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/BLK" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Bolton</div>
          <div class="meta">
            <span>CRS: BON</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/bon/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/BON" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Bramhall</div>
          <div class="meta">
            <span>CRS: BML</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/bml/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/BML" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Bredbury</div>
          <div class="meta">
            <span>CRS: BDY</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/bdy/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/BDY" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Brinnington</div>
          <div class="meta">
            <span>CRS: BNT</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/bnt/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/BNT" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Broadbottom</div>
          <div class="meta">
            <span>CRS: BDB</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/bdb/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/BDB" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Bromley Cross</div>
          <div class="meta">
            <span>CRS: BMC</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/bmc/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/BMC" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Bryn</div>
          <div class="meta">
            <span>CRS: BYN</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/byn/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/BYN" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Burnage</div>
          <div class="meta">
            <span>CRS: BNA</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/bna/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/BNA" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Burrs Country Park Halt</div>
          <div class="meta">
            <span>CRS: —</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Bury, Bolton Street</div>
          <div class="meta">
            <span>CRS: —</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Castleton</div>
          <div class="meta">
            <span>CRS: CAS</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/cas/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/CAS" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Chassen Road</div>
          <div class="meta">
            <span>CRS: CSR</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/csr/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/CSR" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Cheadle Hulme</div>
          <div class="meta">
            <span>CRS: CHU</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/chu/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/CHU" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Clifton</div>
          <div class="meta">
            <span>CRS: CLI</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/cli/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/CLI" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Daisy Hill</div>
          <div class="meta">
            <span>CRS: DSY</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/dsy/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/DSY" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Davenport</div>
          <div class="meta">
            <span>CRS: DVN</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/dvn/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/DVN" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Deansgate</div>
          <div class="meta">
            <span>CRS: DGT</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/dgt/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/DGT" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Denton</div>
          <div class="meta">
            <span>CRS: DTN</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/dtn/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/DTN" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">East Didsbury</div>
          <div class="meta">
            <span>CRS: EDY</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/edy/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/EDY" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Eccles</div>
          <div class="meta">
            <span>CRS: ECC</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/ecc/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/ECC" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Fairfield</div>
          <div class="meta">
            <span>CRS: FRF</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/frf/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/FRF" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Farnworth</div>
          <div class="meta">
            <span>CRS: FNW</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/fnw/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/FNW" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Flixton</div>
          <div class="meta">
            <span>CRS: FLI</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/fli/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/FLI" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Flowery Field</div>
          <div class="meta">
            <span>CRS: FLF</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/flf/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/FLF" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Gathurst</div>
          <div class="meta">
            <span>CRS: GST</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/gst/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/GST" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Gatley</div>
          <div class="meta">
            <span>CRS: GTY</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/gty/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/GTY" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Godley</div>
          <div class="meta">
            <span>CRS: GDL</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/gdl/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/GDL" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Gorton</div>
          <div class="meta">
            <span>CRS: GTO</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/gto/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/GTO" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Greenfield</div>
          <div class="meta">
            <span>CRS: GNF</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/gnf/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/GNF" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Guide Bridge</div>
          <div class="meta">
            <span>CRS: GUI</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/gui/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/GUI" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Hag Fold</div>
          <div class="meta">
            <span>CRS: HGF</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/hgf/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/HGF" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Hale</div>
          <div class="meta">
            <span>CRS: HAL</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/hal/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/HAL" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Hall Drive</div>
          <div class="meta">
            <span>CRS: —</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Hall i' th' Wood</div>
          <div class="meta">
            <span>CRS: HID</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/hid/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/HID" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Hattersley</div>
          <div class="meta">
            <span>CRS: HTY</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/hty/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/HTY" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Hazel Grove</div>
          <div class="meta">
            <span>CRS: HAZ</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/haz/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/HAZ" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Heald Green</div>
          <div class="meta">
            <span>CRS: HDG</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/hdg/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/HDG" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Heaton Chapel</div>
          <div class="meta">
            <span>CRS: HTC</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/htc/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/HTC" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Heywood</div>
          <div class="meta">
            <span>CRS: —</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Hindley</div>
          <div class="meta">
            <span>CRS: HIN</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/hin/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/HIN" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Horwich Parkway</div>
          <div class="meta">
            <span>CRS: HWI</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/hwi/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/HWI" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Humphrey Park</div>
          <div class="meta">
            <span>CRS: HUP</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/hup/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/HUP" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Hyde Central</div>
          <div class="meta">
            <span>CRS: HYC</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/hyc/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/HYC" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Hyde North</div>
          <div class="meta">
            <span>CRS: HYT</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/hyt/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/HYT" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Ince</div>
          <div class="meta">
            <span>CRS: INC</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/inc/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/INC" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Irlam</div>
          <div class="meta">
            <span>CRS: IRL</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/irl/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/IRL" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Kearsley</div>
          <div class="meta">
            <span>CRS: KSL</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/ksl/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/KSL" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Levenshulme</div>
          <div class="meta">
            <span>CRS: LVM</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/lvm/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/LVM" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Littleborough</div>
          <div class="meta">
            <span>CRS: LTL</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/ltl/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/LTL" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Lostock</div>
          <div class="meta">
            <span>CRS: LOT</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/lot/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/LOT" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Manchester Airport</div>
          <div class="meta">
            <span>CRS: MIA</span>
            <span>•</span><span style="color:#ffcc00;font-weight:700;">Pinned hub</span>
            <span>•</span><span style="color:#ffcc00;font-weight:700;">GM terminus</span>
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/mia/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/MIA" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Manchester Oxford Road</div>
          <div class="meta">
            <span>CRS: MCO</span>
            <span>•</span><span style="color:#ffcc00;font-weight:700;">Pinned hub</span>
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/mco/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/MCO" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Manchester Piccadilly</div>
          <div class="meta">
            <span>CRS: MAN</span>
            <span>•</span><span style="color:#ffcc00;font-weight:700;">Pinned hub</span>
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/man/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/MAN" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Manchester Victoria</div>
          <div class="meta">
            <span>CRS: MCV</span>
            <span>•</span><span style="color:#ffcc00;font-weight:700;">Pinned hub</span>
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/mcv/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/MCV" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Marple</div>
          <div class="meta">
            <span>CRS: MPL</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/mpl/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/MPL" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Mauldeth Road</div>
          <div class="meta">
            <span>CRS: MAU</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/mau/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/MAU" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Middlewood</div>
          <div class="meta">
            <span>CRS: MDL</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/mdl/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/MDL" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Mills Hill</div>
          <div class="meta">
            <span>CRS: MIH</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/mih/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/MIH" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Moorside</div>
          <div class="meta">
            <span>CRS: MSD</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/msd/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/MSD" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Moses Gate</div>
          <div class="meta">
            <span>CRS: MSS</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/mss/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/MSS" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Mossley</div>
          <div class="meta">
            <span>CRS: MSL</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/msl/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/MSL" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Moston</div>
          <div class="meta">
            <span>CRS: MSO</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/mso/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/MSO" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Navigation Road</div>
          <div class="meta">
            <span>CRS: NVR</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/nvr/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/NVR" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Newton for Hyde</div>
          <div class="meta">
            <span>CRS: NWN</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/nwn/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/NWN" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Orrell</div>
          <div class="meta">
            <span>CRS: ORR</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/orr/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/ORR" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Patricroft</div>
          <div class="meta">
            <span>CRS: PAT</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/pat/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/PAT" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Pemberton</div>
          <div class="meta">
            <span>CRS: PEM</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/pem/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/PEM" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Ramsbottom</div>
          <div class="meta">
            <span>CRS: —</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Reddish North</div>
          <div class="meta">
            <span>CRS: RDN</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/rdn/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/RDN" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Reddish South</div>
          <div class="meta">
            <span>CRS: RDS</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/rds/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/RDS" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Rochdale</div>
          <div class="meta">
            <span>CRS: RCD</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/rcd/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/RCD" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Romiley</div>
          <div class="meta">
            <span>CRS: RML</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/rml/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/RML" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Rose Hill Marple</div>
          <div class="meta">
            <span>CRS: RSH</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/rsh/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/RSH" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Ryder Brow</div>
          <div class="meta">
            <span>CRS: RRB</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/rrb/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/RRB" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Salford Central</div>
          <div class="meta">
            <span>CRS: SFD</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/sfd/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/SFD" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Salford Crescent</div>
          <div class="meta">
            <span>CRS: SLD</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/sld/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/SLD" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Smithy Bridge</div>
          <div class="meta">
            <span>CRS: SMB</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/smb/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/SMB" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Stalybridge</div>
          <div class="meta">
            <span>CRS: SYB</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/syb/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/SYB" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Stockport</div>
          <div class="meta">
            <span>CRS: SPT</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/spt/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/SPT" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Strines</div>
          <div class="meta">
            <span>CRS: SRN</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/srn/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/SRN" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Summerseat</div>
          <div class="meta">
            <span>CRS: —</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Swinton (Manchester)</div>
          <div class="meta">
            <span>CRS: SNN</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/snn/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/SNN" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Trafford Park</div>
          <div class="meta">
            <span>CRS: TRA</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/tra/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/TRA" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Trencherbone Platform</div>
          <div class="meta">
            <span>CRS: —</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Urmston</div>
          <div class="meta">
            <span>CRS: URM</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/urm/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/URM" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Walkden</div>
          <div class="meta">
            <span>CRS: WKD</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/wkd/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/WKD" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Walker Gardens</div>
          <div class="meta">
            <span>CRS: —</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Westhoughton</div>
          <div class="meta">
            <span>CRS: WHG</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/whg/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/WHG" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Whitehead Lane</div>
          <div class="meta">
            <span>CRS: —</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Wigan North Western</div>
          <div class="meta">
            <span>CRS: WGN</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/wgn/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/WGN" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Wigan Wallgate</div>
          <div class="meta">
            <span>CRS: WGW</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/wgw/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/WGW" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Woodley</div>
          <div class="meta">
            <span>CRS: WLY</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/wly/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/WLY" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div><div class="row">
          <div class="name">Woodsmoor</div>
          <div class="meta">
            <span>CRS: WSR</span>
            
            
            <span>•</span>
            <a href="https://www.nationalrail.co.uk/stations/wsr/" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="https://www.realtimetrains.co.uk/search/detailed/WSR" target="_blank" rel="noopener">Realtime</a>
          </div>
          
        </div></div>
        </div>

        <div style="height:12px"></div>

        <div class="card">
          <div class="section-title"><span>Selected</span></div>
          <div id="selected" class="muted">Daisy Hill (DSY)</div>
          <div class="muted" style="margin-top:8px;">
            GM termini pinned by default: <b>Manchester Airport (MIA)</b>, <b>Rose Hill Marple (RHM)</b>.
          </div>
        </div>

      </aside>

      <div id="map" class="leaflet-container leaflet-touch leaflet-fade-anim leaflet-grab leaflet-touch-drag leaflet-touch-zoom" tabindex="0" style="position: relative;"><div class="leaflet-pane leaflet-map-pane" style="transform: translate3d(0px, 0px, 0px);"><div class="leaflet-pane leaflet-tile-pane"><div class="leaflet-layer " style="z-index: 1; opacity: 1;"><div class="leaflet-tile-container leaflet-zoom-animated" style="z-index: 18; transform: translate3d(157px, 159px, 0px) scale(0.5);"></div><div class="leaflet-tile-container leaflet-zoom-animated" style="z-index: 19; transform: translate3d(157px, 159px, 0px) scale(1);"><img alt="" src="./Bee Network Rail Dashboard_files/1324.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(265px, 208px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1324(1).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(521px, 208px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1323.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(265px, -48px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1323(1).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(521px, -48px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1325.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(265px, 464px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1325(1).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(521px, 464px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1324(2).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(9px, 208px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1324(3).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(777px, 208px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1323(2).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(9px, -48px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1323(3).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(777px, -48px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1325(2).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(9px, 464px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1325(3).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(777px, 464px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1322.png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(521px, -304px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1322(1).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(265px, -304px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1322(2).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(777px, -304px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1323(4).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1033px, -48px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1324(4).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1033px, 208px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1322(3).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(9px, -304px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1322(4).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1033px, -304px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1325(4).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1033px, 464px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1323(5).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-247px, -48px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1323(6).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1289px, -48px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1324(5).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-247px, 208px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1324(6).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1289px, 208px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1322(5).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-247px, -304px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1322(6).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1289px, -304px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1325(5).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(-247px, 464px, 0px); opacity: 1;"><img alt="" src="./Bee Network Rail Dashboard_files/1325(6).png" class="leaflet-tile leaflet-tile-loaded" style="width: 256px; height: 256px; transform: translate3d(1289px, 464px, 0px); opacity: 1;"></div></div></div><div class="leaflet-pane leaflet-overlay-pane"><svg pointer-events="none" class="leaflet-zoom-animated" width="1742" height="1020" viewBox="-145 -85 1742 1020" style="transform: translate3d(-145px, -85px, 0px);"><g><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1394,706a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M921,346a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1100,455a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M355,117a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M128,566a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1042,635a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1102,-63a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1131,19a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1140,109a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1552,878a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M64,415a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M167,344a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M-51,417a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M818,6a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M811,87a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1033,492a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M171,352a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1412,128a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1515,315a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M776,204a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M258,216a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1516,451a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M-6,273a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1558,810a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1508,775a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1497,110a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.95" fill-rule="evenodd" d="M1342,676a8,8 0 1,0 16,0 a8,8 0 1,0 -16,0 " aria-describedby="leaflet-tooltip-233"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.95" fill-rule="evenodd" d="M1307,693a8,8 0 1,0 16,0 a8,8 0 1,0 -16,0 " aria-describedby="leaflet-tooltip-235"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1283,691a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1270,648a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.95" fill-rule="evenodd" d="M1306,623a8,8 0 1,0 16,0 a8,8 0 1,0 -16,0 " aria-describedby="leaflet-tooltip-239"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1569,22a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M573,208a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M491,291a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M442,182a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M845,289a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M883,317a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1446,702a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1490,753a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1526,717a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1592,705a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1492,927a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1107,786a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1061,798a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M896,840a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M943,828a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M984,817a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M754,886a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1453,834a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M514,372a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M987,484a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M862,468a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M623,422a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.95" fill-rule="evenodd" d="M0 0" aria-describedby="leaflet-tooltip-277"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1212,632a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M253,227a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M576,400a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M723,591a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M716,587a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M230,373a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M341,356a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M974,639a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M0 0"></path><path class="leaflet-interactive" stroke="#ffcc00" stroke-opacity="1" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="#ffcc00" fill-opacity="0.9" fill-rule="evenodd" d="M1406,889a6,6 0 1,0 12,0 a6,6 0 1,0 -12,0 "></path></g></svg></div><div class="leaflet-pane leaflet-shadow-pane"></div><div class="leaflet-pane leaflet-marker-pane"></div><div class="leaflet-pane leaflet-tooltip-pane"><div class="leaflet-tooltip station-label pinned leaflet-zoom-animated leaflet-tooltip-right" role="tooltip" id="leaflet-tooltip-233" style="opacity: 1; transform: translate3d(1360px, 662px, 0px);">Manchester Piccadilly</div><div class="leaflet-tooltip station-label pinned leaflet-zoom-animated leaflet-tooltip-right" role="tooltip" id="leaflet-tooltip-235" style="opacity: 1; transform: translate3d(1325px, 679px, 0px);">Manchester Oxford Road</div><div class="leaflet-tooltip station-label pinned leaflet-zoom-animated leaflet-tooltip-right" role="tooltip" id="leaflet-tooltip-239" style="opacity: 1; transform: translate3d(1324px, 609px, 0px);">Manchester Victoria</div><div class="leaflet-tooltip station-label terminus leaflet-zoom-animated leaflet-tooltip-right" role="tooltip" id="leaflet-tooltip-277" style="opacity: 1; transform: translate3d(1238px, 1210px, 0px);">Manchester Airport</div></div><div class="leaflet-pane leaflet-popup-pane"><div class="leaflet-popup  leaflet-zoom-animated" style="opacity: 1; transform: translate3d(520px, 372px, 0px); bottom: -7px; left: -155px;"><div class="leaflet-popup-content-wrapper"><div class="leaflet-popup-content" style="width: 261px;">
        <div style="min-width:260px">
          <div style="font-weight:700; font-size:14px;">Daisy Hill</div>
          <div style="color:#94a3b8; margin-top:2px;">CRS: DSY</div>
          
          <div class="pop-h">About this station</div>
          <div class="pop-p">
            <span class="wiki-summary" data-qid="Q1822126" data-key="node/6569339484">Daisy Hill railway station serves the Daisy Hill area of Westhoughton, in the Metropolitan Borough of Bolton, Greater Manchester, England. <a href="https://en.wikipedia.org/wiki/Daisy_Hill_railway_station" target="_blank" rel="noopener">(Wikipedia)</a></span>
          </div>
        
          <div class="pop-links">
            <a href="https://www.nationalrail.co.uk/stations/dsy/" target="_blank" rel="noopener">National Rail Enquiries</a>
            <a href="https://www.realtimetrains.co.uk/search/detailed/DSY" target="_blank" rel="noopener">Realtime Trains</a>
          </div>
        </div>
      </div></div><div class="leaflet-popup-tip-container"><div class="leaflet-popup-tip"></div></div><a class="leaflet-popup-close-button" role="button" aria-label="Close popup" href="https://antrail.github.io/rail/index.html#close"><span aria-hidden="true">×</span></a></div></div><div class="leaflet-proxy leaflet-zoom-animated" style="transform: translate3d(517168px, 339002px, 0px) scale(2048);"></div></div><div class="leaflet-control-container"><div class="leaflet-top leaflet-left"><div class="leaflet-control-zoom leaflet-bar leaflet-control"><a class="leaflet-control-zoom-in" href="https://antrail.github.io/rail/index.html#" title="Zoom in" role="button" aria-label="Zoom in" aria-disabled="false"><span aria-hidden="true">+</span></a><a class="leaflet-control-zoom-out" href="https://antrail.github.io/rail/index.html#" title="Zoom out" role="button" aria-label="Zoom out" aria-disabled="false"><span aria-hidden="true">−</span></a></div></div><div class="leaflet-top leaflet-right"></div><div class="leaflet-bottom leaflet-left"></div><div class="leaflet-bottom leaflet-right"><div class="leaflet-control-attribution leaflet-control"><a href="https://leafletjs.com/" title="A JavaScript library for interactive maps"><svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"></path><path fill="#FFD500" d="M0 4h12v3H0z"></path><path fill="#E0BC00" d="M0 7h12v1H0z"></path></svg> Leaflet</a> <span aria-hidden="true">|</span> © OpenStreetMap contributors © CARTO</div></div></div></div>
    </main>
  </div>

  <script src="./Bee Network Rail Dashboard_files/leaflet.js.download"></script>

  <script>
    /**********************
     * PINNED + TERMINI
     **********************/
    const PINNED_HUBS_CRS = new Set([
      "MAN", // Manchester Piccadilly
      "MCO", // Manchester Oxford Road
      "MCV", // Manchester Victoria
      "BOL", // Bolton
      "MIA"  // Manchester Airport
    ]);

    const GM_TERMINI_CRS = new Set([
      "MIA", // Manchester Airport
      "RHM"  // Rose Hill Marple
    ]);

    document.getElementById("buildStamp").textContent =
      "Build: " + new Date().toISOString().slice(0,10);

    // Tools menu behaviour
    const TOOL_URLS = {
      ccil: "https://ccil.clyx.net/CCIL/NewApplication/Default.aspx",
      rtt:  "https://www.realtimetrains.co.uk/",
      nre:  "https://www.nationalrail.co.uk/"
    };

    document.getElementById("openToolBtn").addEventListener("click", () => {
      const key = document.getElementById("toolSelect").value;
      const url = TOOL_URLS[key];
      if (url) window.open(url, "_blank", "noopener");
    });

    // Map
    const map = L.map("map", { zoomControl: true }).setView([53.48, -2.24], 10);
 map.on("zoomend", () => { if (window.__labelsEnabled && window.__labelsZoomOnly) rerenderCurrent(); });

    L.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png", {
      subdomains: "abcd",
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap contributors &copy; CARTO'
    }).addTo(map);

    let allFeatures = [];
    let markerLayer = null;
    const markerById = new Map();

    function featureId(f, idx){
      return (f.id || f.properties?.["@id"] || f.properties?.id || ("idx:" + idx));
    }

    function getCrs(props){
      return String(props?.crs ?? props?.["ref:crs"] ?? "").toUpperCase();
    }

    function getWikidataQid(props){
      const q = String(props?.wikidata ?? props?.["network:wikidata"] ?? "").trim();
      return /^Q\d+$/i.test(q) ? q.toUpperCase() : "";
    }

    function escapeHtml(s){
      return String(s || "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function routesDescription(props){
      const d = String(props?.description ?? "").trim();
      if (!d) return null;
      return d.length > 240 ? (d.slice(0, 240) + "…") : d;
    }

    function nreLink(props){
      const direct = props?.["network:website"];
      if (direct && /^https:\/\/www\.nationalrail\.co\.uk\/stations\//i.test(direct)) return direct;
      return "https://www.nationalrail.co.uk/stations/";
    }

    function rttLink(props){
      const crs = getCrs(props);
      if (crs) return `https://www.realtimetrains.co.uk/search/detailed/${encodeURIComponent(crs)}`;
      return nreLink(props);
    }

    /***********************
     * Wikipedia summary cache
     ***********************/
    const wikiMemCache = new Map();
    const WIKI_TTL_MS = 1000 * 60 * 60 * 24 * 30;

    function loadStoredWiki(qid){
      try{
        const raw = localStorage.getItem("wikiSummary:" + qid);
        if (!raw) return null;
        const obj = JSON.parse(raw);
        if (!obj || !obj.ts) return null;
        if (Date.now() - obj.ts > WIKI_TTL_MS) return null;
        return obj;
      } catch { return null; }
    }
    function storeWiki(qid, obj){
      try{ localStorage.setItem("wikiSummary:" + qid, JSON.stringify(obj)); } catch {}
    }

    async function fetchWikipediaSummaryFromWikidata(qid){
      const wdUrl = `https://www.wikidata.org/wiki/Special:EntityData/${encodeURIComponent(qid)}.json`;
      const wdRes = await fetch(wdUrl, { headers: { "Accept": "application/json" } });
      if (!wdRes.ok) throw new Error("Wikidata fetch failed");
      const wd = await wdRes.json();

      const ent = wd?.entities?.[qid];
      const enwikiTitle = ent?.sitelinks?.enwiki?.title;
      if (!enwikiTitle) return { title: "", extract: "", url: "" };

      const wpUrl = `https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(enwikiTitle)}`;
      const wpRes = await fetch(wpUrl, { headers: { "Accept": "application/json" } });
      if (!wpRes.ok) throw new Error("Wikipedia summary fetch failed");
      const wp = await wpRes.json();

      return {
        title: String(wp?.title ?? enwikiTitle),
        extract: String(wp?.extract ?? "").trim(),
        url: String(wp?.content_urls?.desktop?.page ?? "")
      };
    }

    async function getWikiSummary(qid){
      if (!qid) return null;

      if (wikiMemCache.has(qid)) {
        const obj = wikiMemCache.get(qid);
        if (Date.now() - obj.ts <= WIKI_TTL_MS) return obj;
      }

      const stored = loadStoredWiki(qid);
      if (stored) { wikiMemCache.set(qid, stored); return stored; }

      const { title, extract, url } = await fetchWikipediaSummaryFromWikidata(qid);
      const obj = { ts: Date.now(), title, extract, url };
      wikiMemCache.set(qid, obj);
      storeWiki(qid, obj);
      return obj;
    }

    function truncate(s, n){
      const t = String(s || "").trim();
      if (!t) return "";
      return t.length > n ? (t.slice(0, n) + "…") : t;
    }

    function stationLabelText(name){
      return String(name || "").replace(/^Manchester\s+/i, "Manchester ").trim();
    }

    function markerStyleFor(f){
 const crs = getCrs(f.properties);
 const isTerminus = GM_TERMINI_CRS.has(crs);
 const isPinned = PINNED_HUBS_CRS.has(crs);
 // Bee theme: yellow fill with black outline; termini inverted for contrast
 if (isTerminus) return { radius: 8, weight: 3, color: "#ffcc00", fillColor: "#0a0a0a", fillOpacity: 0.95 };
 if (isPinned) return { radius: 8, weight: 3, color: "#0a0a0a", fillColor: "#ffcc00", fillOpacity: 0.95 };
 return { radius: 6, weight: 2, color: "#0a0a0a", fillColor: "#ffcc00", fillOpacity: 0.85 };
}


    function maybeBindPermanentLabel(layer, f){
 const crs = getCrs(f.properties);
 const name = f.properties?.name ?? "Station";
 const isTerminus = GM_TERMINI_CRS.has(crs);
 const isPinned = PINNED_HUBS_CRS.has(crs);
 if (!window.__labelsEnabled) return;
 const threshold = window.__labelZoomThreshold || 14;
 const zoomOnly = !!window.__labelsZoomOnly;
 // When zoom-only mode is enabled, show labels only at/above threshold,
 // but keep pinned hubs & termini labelled at any zoom for orientation.
 if (zoomOnly && map && map.getZoom && map.getZoom() < threshold && !(isPinned || isTerminus)) return;
 const cls = isTerminus ? "station-label terminus" : (isPinned ? "station-label pinned" : "station-label");
 layer.bindTooltip(stationLabelText(name), {
  permanent: true,
  direction: "right",
  offset: [10, 0],
  opacity: 1,
  className: cls
 });
}


    function popupHtml(name, crs, props, stationKey){
      const desc = routesDescription(props);
      const qid = getWikidataQid(props);
      const nre = nreLink(props);
      const rtt = rttLink(props);

      const aboutBlock = desc
        ? `
          <div class="pop-h">Routes served</div>
          <div class="pop-p">${escapeHtml(desc)}</div>
        `
        : `
          <div class="pop-h">About this station</div>
          <div class="pop-p">
            <span class="wiki-summary" data-qid="${escapeHtml(qid)}" data-key="${escapeHtml(stationKey)}">
              ${qid ? "Loading Wikipedia summary…" : "No Wikidata tag found for this station."}
            </span>
          </div>
        `;

      return `
        <div style="min-width:260px">
          <div style="font-weight:700; font-size:14px;">${escapeHtml(name)}</div>
          ${crs ? `<div style="color:#94a3b8; margin-top:2px;">CRS: ${escapeHtml(crs)}</div>` : ``}
          ${aboutBlock}
          <div class="pop-links">
            <a href="${nre}" target="_blank" rel="noopener">National Rail Enquiries</a>
            <a href="${rtt}" target="_blank" rel="noopener">Realtime Trains</a>
          </div>
        </div>
      `;
    }

    async function hydratePopupWithWiki(layer){
      const popup = layer.getPopup();
      const el = popup?.getElement();
      if (!el) return;

      const span = el.querySelector(".wiki-summary");
      if (!span) return;

      const qid = span.getAttribute("data-qid") || "";
      if (!qid) return;

      try{
        const summary = await getWikiSummary(qid);
        if (!summary) return;

        const extract = truncate(summary.extract, 260);
        if (!extract) { span.textContent = "No Wikipedia summary available."; return; }

        const link = summary.url ? ` <a href="${summary.url}" target="_blank" rel="noopener">(Wikipedia)</a>` : "";
        span.innerHTML = `${escapeHtml(extract)}${link}`;
      } catch {
        span.textContent = "Couldn’t load Wikipedia summary right now.";
      }
    }

    function renderMarkers(features){
      if (markerLayer) markerLayer.remove();

      markerLayer = L.geoJSON({ type:"FeatureCollection", features }, {
        pointToLayer: (f, latlng) => {
          const m = L.circleMarker(latlng, markerStyleFor(f));
          maybeBindPermanentLabel(m, f);
          return m;
        },

        onEachFeature: (f, l) => {
          const name = f.properties?.name ?? "Station";
          const crs  = getCrs(f.properties);
          const id   = featureId(f, 0);

          l.bindPopup(popupHtml(name, crs, f.properties, id));

          l.on("click", () => {
            document.getElementById("selected").textContent = crs ? `${name} (${crs})` : name;
          });

          l.on("popupopen", async () => {
            await hydratePopupWithWiki(l);
          });
        }
      }).addTo(map);

      markerById.clear();
      let idx = 0;
      markerLayer.eachLayer(layer => {
        const f = layer.feature;
        const id = featureId(f, idx++);
        markerById.set(id, layer);
      });

      return markerLayer;
    }

    function renderList(features){
      const list = document.getElementById("list");
      list.innerHTML = "";

      const sorted = [...features].sort((a,b) => {
        const an = (a.properties?.name || "").toLowerCase();
        const bn = (b.properties?.name || "").toLowerCase();
        return an.localeCompare(bn);
      });

      sorted.forEach((f, idx) => {
        const id = featureId(f, idx);
        const name = f.properties?.name ?? "Station";
        const crs  = getCrs(f.properties);

        const nre = nreLink(f.properties);
        const rtt = rttLink(f.properties);

        const desc = routesDescription(f.properties);

        const el = document.createElement("div");
        el.className = "row";
        el.innerHTML = `
          <div class="name">${escapeHtml(name)}</div>
          <div class="meta">
            <span>${crs ? "CRS: " + escapeHtml(crs) : "CRS: —"}</span>
            ${PINNED_HUBS_CRS.has(crs) ? `<span>•</span><span style="color:#ffcc00;font-weight:700;">Pinned hub</span>` : ``}
            ${GM_TERMINI_CRS.has(crs) ? `<span>•</span><span style="color:#ffcc00;font-weight:700;">GM terminus</span>` : ``}
            <span>•</span>
            <a href="${nre}" target="_blank" rel="noopener">NRE</a>
            <span>•</span>
            <a href="${rtt}" target="_blank" rel="noopener">Realtime</a>
          </div>
          ${desc ? `<div class="desc">${escapeHtml(desc)}</div>` : ``}
        `;

        el.addEventListener("click", () => {
          const layer = markerById.get(id);
          if (!layer) return;

          const ll = layer.getLatLng();
          map.setView(ll, Math.max(map.getZoom(), 13), { animate: true });
          layer.openPopup();

          document.getElementById("selected").textContent = crs ? `${name} (${crs})` : name;
        });

        list.appendChild(el);
      });

      document.getElementById("listCount").textContent = `${sorted.length} listed`;
    }

    function applyFilter(){
      const q = document.getElementById("q").value.trim().toLowerCase();
      const filtered = !q ? allFeatures : allFeatures.filter(f => {
        const name = (f.properties?.name || "").toLowerCase();
        return name.includes(q);
      });

      document.getElementById("kpiShowing").textContent = String(filtered.length);
      document.getElementById("resultCount").textContent = q ? `Matches: ${filtered.length}` : `All: ${filtered.length}`;

      renderMarkers(filtered);
      renderList(filtered);

      if (!q && markerLayer && markerLayer.getBounds().isValid()){
        map.fitBounds(markerLayer.getBounds(), { padding: [20,20] });
      }
    }

    async function loadStations(){
      const res = await fetch("./data/stations.geojson");
      if (!res.ok) throw new Error(`Failed to load stations.geojson (${res.status})`);
      const gj = await res.json();

      allFeatures = (gj.features || []).filter(f => f.geometry && f.geometry.type === "Point");
      document.getElementById("kpiStations").textContent = String(allFeatures.length);

      renderMarkers(allFeatures);
      renderList(allFeatures);
      document.getElementById("kpiShowing").textContent = String(allFeatures.length);
      document.getElementById("resultCount").textContent = `All: ${allFeatures.length}`;

      if (markerLayer && markerLayer.getBounds().isValid()){
        map.fitBounds(markerLayer.getBounds(), { padding: [20,20] });
      }
    }

    document.getElementById("q").addEventListener("input", applyFilter);
    document.getElementById("clearBtn").addEventListener("click", () => {
      document.getElementById("q").value = "";
      applyFilter();
    });

    loadStations().catch(err => alert(err.message));
  </script>

</body></html>